# =========================================================
# Hyprland 0.53.1 Main Config (Updated 2026)
# =========================================================

$hypr = ~/.config/hypr
$hl = $hypr/hyprland
$cConf = ~/.config/caelestia

# ---------------------------------------------------------
# Environment Variables (Critical for GUI Rendering)
# ---------------------------------------------------------
env = QT_QPA_PLATFORM,wayland;xcb
env = GDK_BACKEND,wayland,x11
env = CLUTTER_BACKEND,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

# ---------------------------------------------------------
# 0.53.x Start-up
# ---------------------------------------------------------
# Added 2s delay to Caelestia to prevent race condition blank screen
exec-once = cp -L --no-preserve=mode --update=none $hypr/scheme/default.conf $hypr/scheme/current.conf
exec-once = sleep 2 && caelestia shell

# Source core configurations
source = $hypr/scheme/current.conf
source = $hypr/variables.conf
source = $cConf/hypr-vars.conf

# Monitor - 0.53 Syntax
monitor = HDMI-A-6, 1920x1080@180, 0x0, 1

# ---------------------------------------------------------
# Core Settings
# ---------------------------------------------------------

general {
    gaps_in = 5
    gaps_out = 20
    border_size = 2
    col.active_border = rgba(33ccffee)
    col.inactive_border = rgba(595959aa)
    layout = dwindle
    resize_on_border = true 
}

decoration {
    rounding = 10
    # 0.53.1: rounding_power adjusts the squircle curve
    rounding_power = 2.0 
    
    # CRITICAL: Shadows MUST be in their own block in 0.53.x
    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }

    blur {
        enabled = true
        size = 3
        passes = 1
    }
}

input {
    kb_layout = us
    follow_mouse = 1
    touchpad {
        natural_scroll = no
    }
}

misc {
    # 0.53.1 Change: Renamed from new_window_takes_over_fs
    # Options are: 0 (off), 1 (takes over), 2 (unfullscreen)
    on_focus_under_fullscreen = 1
    
    force_default_wallpaper = 0
    disable_hyprland_logo = true
    # Improved performance for 2026 hardware
    vrr = 1 
}

# ---------------------------------------------------------
# Config Source Imports
# ---------------------------------------------------------
source = $hl/env.conf
source = $hl/general.conf
source = $hl/input.conf
source = $hl/misc.conf
source = $hl/animations.conf
source = $hl/decoration.conf
source = $hl/group.conf
source = $hl/execs.conf
source = $hl/rules.conf     # Ensure this uses the 'match:' and 'namespace:' syntax
source = $hl/gestures.conf
source = $hl/keybinds.conf  

# User configs
exec = mkdir -p $cConf && touch -a $cConf/hypr-user.conf
source = $cConf/hypr-user.conf
